# 외국어 대화 학습 앱 기획

## 개요

- **목표**: 일본어 회화 학습 앱
- **핵심 방식**: 예시 회화 따라가기 (스크립트 기반)
- **차별점**: 페르소나 기반 콘텐츠 + SRS(간격 반복) 조합

---

## 핵심 설계 원칙

### 왜 자유 대화가 아닌가?

- 초보자는 단어 인출에 어려움이 있음
- 스크립트 기반은 난이도 제어가 쉽고, LLM 비용이 낮음
- 점진적 확장 가능: 스크립트 → 빈칸 채우기 → 힌트 자유응답 → 완전 자유 대화

### 왜 페르소나인가?

- 사용자마다 일본 방문 목적이 다름
- 목적에 맞는 상황을 우선 학습해야 동기부여 유지
- "모두가 알아야 할 기초"는 최소화하고, 상황 안에 자연스럽게 녹임

### 왜 SRS인가?

- 회화 앱 중 SRS 결합한 곳이 드뭄 (차별점)
- 복습과 신규 학습의 균형 자동화

---

## 기술 스택

| 영역          | 선택                       | 이유                       |
| ------------- | -------------------------- | -------------------------- |
| 음성인식(STT) | OpenAI Whisper API         | 다국어 지원, 높은 정확도   |
| 음성합성(TTS) | ElevenLabs 또는 OpenAI TTS | 자연스러운 발음            |
| 프론트엔드    | React Native 또는 Flutter  | 크로스 플랫폼              |
| 백엔드        | Supabase                   | 인증, DB, 실시간 기능 통합 |
| SRS 알고리즘  | FSRS                       | SM-2보다 정확, 오픈소스    |
| 콘텐츠 생성   | Claude/GPT API             | 대량 생성 후 품질 검수     |

---

## 시스템 구조

```
[콘텐츠 생성 파이프라인]          [학습 엔진]
        │                              │
   AI 대량 생성                    SRS 스케줄러
        ↓                              ↓
   품질 검수/태깅              복습 대상 선정 → 세션 구성
        ↓                              ↓
      DB 저장 ──────────────────→ 학습 기록 반영
```

### 학습 플로우

```
사용자 → [씬 제시] → [상대방 대사 재생] → [사용자 발화] → [STT] → [정답 비교] → [피드백]
```

---

## 데이터 모델

### Persona (사용자)

```json
{
  "user_id": "...",
  "gender": "male/female",
  "age_group": "20s/30s/40s/...",
  "visit_purpose": ["관광", "비즈니스", "워홀", "유학"]
}
```

### Situation (상황 = 학습 단위)

```json
{
  "situation_id": "cafe_001",
  "title": "카페 주문",
  "tags": ["관광", "워홀", "일상"],
  "formality": "polite",
  "difficulty": 2,
  "scenes": [
    { "role": "staff", "text": "いらっしゃいませ", "audio_url": "..." },
    { "role": "user", "expected": "コーヒーをください" }
  ],
  "expressions": ["ください", "を"]
}
```

### SRS Record

```json
{
  "user_id": "...",
  "situation_id": "cafe_001",
  "ease": 2.5,
  "interval": 4,
  "due_date": "2025-01-30"
}
```

---

## 페르소나별 콘텐츠 전략

| 페르소나       | 우선 상황                                        | 말투            |
| -------------- | ------------------------------------------------ | --------------- |
| 관광 (20-40대) | 편의점, 식당, 길찾기, 역, 호텔, 쇼핑, 관광지     | 기본 존댓말     |
| 비즈니스       | 공항, 택시, 미팅, 명함 교환, 회식, 작별          | 경어 중심       |
| 워홀/유학      | 부동산, 휴대폰, 은행, 알바 면접, 동료 대화, 병원 | 존댓말 + 캐주얼 |

### 기초 처리 방식

- 별도 모듈 X
- 첫 상황들이 자연스럽게 기초 포함
- 예: 관광 → "편의점에서 물 사기" → すみません, これ, ありがとう 자연 습득

---

## MVP 범위

### 콘텐츠

```
페르소나 3개 × 핵심 상황 7개 = 21개 씬
```

### 개발 순서

1. **콘텐츠 생성 파이프라인** — AI 대량 생성 + 태깅 자동화
2. **페르소나 온보딩 UI** — 성별, 나이, 방문 목적 선택
3. **SRS 엔진** — FSRS 라이브러리 연동
4. **학습 세션 플레이어** — STT + 정답 비교 + 피드백
5. **TTS 연동** — 상대방 대사 음성 재생

---

## 세션 구성 로직

```python
def get_next_session(user):
    # 1. 복습 우선
    due_situations = get_due_for_review(user.id)

    # 2. 신규 학습 - 페르소나 매칭
    if needs_new_content(user):
        new_situations = (
            Situation
            .filter(tags__overlap=user.purpose)
            .filter(formality__in=user.preferred_formality)
            .exclude(id__in=user.learned_ids)
            .order_by('difficulty')
        )

    # 3. 세션 구성: 복습 70% + 신규 30%
    return compose_session(due_situations, new_situations)
```

---

## 비용 구조 (참고)

| 항목              | 단가              |
| ----------------- | ----------------- |
| Whisper API       | 분당 $0.006       |
| TTS (ElevenLabs)  | 월 $5-22 플랜     |
| LLM (콘텐츠 생성) | 대화당 $0.01-0.05 |

학습 시에는 LLM 호출이 거의 없어 비용 효율적.

---

## 다음 단계

- [ ] 콘텐츠 생성 프롬프트 설계
- [ ] 페르소나별 상황 목록 확정
- [ ] 데이터베이스 스키마 확정
- [ ] 프로토타입 UI 설계
