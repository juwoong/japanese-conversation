# 사용자 플로우 (User Flow)

## 1. 첫 실행 - 온보딩

```
[앱 실행]
    ↓
[언어 선택] — "일본어"만 우선 지원 (MVP)
    ↓
[페르소나 설정]
    ├─ 성별 선택 (남/여/미지정)
    ├─ 나이대 선택 (20대/30대/40대+)
    └─ 방문 목적 (복수 선택 가능)
         ├─ 🗼 관광
         ├─ 💼 비즈니스
         └─ 🎒 워홀/유학
    ↓
[추천 학습 경로 제시]
    "관광 목적이시군요! 편의점, 식당, 역에서 바로 쓸 수 있는 표현부터 시작할게요."
    ↓
[첫 상황 미리보기]
    "첫 번째 상황: 편의점에서 물 사기"
    [시작하기] 버튼
```

---

## 2. 홈 화면

```
┌─────────────────────────────────┐
│  오늘의 학습                      │
│  ┌───────────────────────────┐  │
│  │ 복습 3개 + 새로운 상황 1개   │  │
│  │ [학습 시작]                  │  │
│  └───────────────────────────┘  │
│                                 │
│  진행 상황                       │
│  ├─ 배운 상황: 5/21             │
│  └─ 오늘 연속 학습: 3일째        │
│                                 │
│  [전체 상황 보기]                │
│  [설정]                         │
└─────────────────────────────────┘
```

### 홈 화면 핵심 원칙
- **결정 피로 최소화**: "오늘 뭐 할지" 고민 없이 바로 시작
- **SRS 무결성 유지**: 복습은 FSRS가 100% 결정, 사용자 개입 없음
- **신규 상황 해금**:
  - 초반 (Lv.1~2): 추천 순서대로 (가이드 모드)
  - 중반 이후 (Lv.3+): 해금된 상황 중 자유 선택 가능

```
오늘의 학습
├─ 복습 3개 ← FSRS가 결정 (변경 불가)
└─ 신규 1개 ← Lv.1~2: 자동 추천 / Lv.3+: [선택하기] 버튼
```

---

## 3. 학습 모드

### 3.0 학습 모드 구분

```
학습 모드
├─ 목적 있는 발화 (Situation Role Play)
│   └─ 실제 상황에서 대화 수행
│
└─ 목적 없는 발화 (Drill Practice)
    ├─ 1. 따라 발화하기 (Shadowing)
    ├─ 2. 안 보고 발화하기 (Recall)
    ├─ 3. 발음 교정하기 (Pronunciation)
    └─ 4. 가족에게 보내주기 (Share Recording)
```

#### 목적 있는 발화 (Role Play)
- 상황 안에서 NPC와 실제 대화
- 내가 상황을 주도 (단순 응답 X)
- 카운트다운/시간 제한 옵션

#### 목적 없는 발화 (Drill)
| 단계 | 모드 | 설명 | 해금 레벨 |
|------|------|------|----------|
| 1 | 따라 발화하기 | TTS 듣고 바로 따라 말하기 (Shadowing) | Lv.1 |
| 2 | 안 보고 발화하기 | 번역만 보고 일본어 말하기 (Recall) | Lv.2 |
| 3 | 발음 교정하기 | STT 결과와 정답 비교, 피드백 | Lv.3 |
| 4 | 가족에게 보내주기 | 녹음 파일 저장/공유 (동기부여) | Lv.3 |

```
Lv.1: [따라하기] ─────────────────────────────
Lv.2: [따라하기] → [안 보고 말하기] ───────────
Lv.3: [따라하기] → [안 보고] → [발음교정] → [공유]
```

※ Drill은 개별 대사 단위, Role Play는 상황 전체 단위

---

### 3.1 세션 시작

```
[세션 구성 화면]
    "오늘의 학습"
    ├─ 복습: 카페 주문, 길 묻기, 역에서
    └─ 신규: 편의점에서 계산

    예상 시간: 10분
    [시작]
```

### 3.2 상황(Situation) 진입

#### Lecture 모드 (선택)
상황 진입 전 짧은 설명/미리보기

```
[Lecture 화면]
    ┌─────────────────────────┐
    │ 📍 편의점에서 물건 사기   │
    │                         │
    │ 이번에 배울 표현:        │
    │ • ください (주세요)      │
    │ • 〜円 (~엔)            │
    │                         │
    │ [강의 보기] [바로 시작]  │
    └─────────────────────────┘
```

※ Lecture는 첫 학습 시에만 표시, 복습 시 스킵 가능

---

#### 상황 인트로

```
[상황 인트로]
    ┌─────────────────────────┐
    │ 📍 편의점               │
    │                         │
    │ 물을 사려고 합니다.      │
    │ 점원에게 말을 걸어보세요. │
    │                         │
    │ ⏱️ 시간 제한: OFF       │
    │ [설정] [대화 시작]       │
    └─────────────────────────┘
```

#### Role Play 옵션
| 옵션 | 설명 |
|------|------|
| 시간 제한 | 카운트다운 ON/OFF (긴장감 조절) |
| 힌트 표시 | 예시 대사 보기/숨기기 |
| 사용자 주도 | 내가 먼저 말 걸기 모드 (고급)

### 3.3 대화 플로우 (핵심)

#### 레벨별 Scaffolding

학습 진행도에 따라 보조 정보를 줄이고, 채점 기준을 높여감:

| 단계 | 발음 가이드 | 번역 | 채점 기준 |
|------|-------------|------|----------|
| Lv.1 (입문) | ✅ 한글 표기 | ✅ 표시 | 핵심 단어만 OK |
| Lv.2 (초급) | ❌ 숨김 | ✅ 표시 | 기본 조사 포함 |
| Lv.3 (중급) | ❌ 숨김 | 👆 탭하면 | 정확한 문장 구조 |

**채점 예시 — "これをください"**
- Lv.1: "코레 쿠다사이" → ✅ (핵심 단어 OK)
- Lv.2: "これください" → ❌ ("を" 필요)
- Lv.3: "これをください" → ✅ (정확)

**Lv.1 예시:**
```
これをください
코레오 쿠다사이
(이것 주세요)
```

**Lv.2 예시:**
```
これをください
(이것 주세요)
```

**Lv.3 예시:**
```
これをください
         [번역 보기]
```

※ 사용자가 설정에서 강제로 발음/번역 표시 가능 (보조바퀴 옵션)

---

#### 대화 화면 구성

```
┌─────────────────────────────────┐
│  [점원 아바타]                   │
│  "いらっしゃいませ"              │
│  이랏샤이마세                    │  ← Lv.1일 때만
│  (어서오세요)                    │
│  🔊 (자동 재생)                 │
└─────────────────────────────────┘
           ↓
┌─────────────────────────────────┐
│  당신의 차례                     │
│                                 │
│  [예시 보기] ← Lv.3부터 기본 숨김 │
│  "これをください"                │
│  코레오 쿠다사이                 │  ← Lv.1일 때만
│  (이것 주세요)                   │
│                                 │
│  🎤 [녹음] 버튼                  │
└─────────────────────────────────┘
           ↓
[사용자 발화]
    ↓
[STT 변환]
    ↓
[정답 비교 + 피드백]
```

### 3.4 피드백 화면

**Case A: 정확**
```
┌─────────────────────────────────┐
│  ✅ 완벽해요!                    │
│                                 │
│  당신: "これをください"          │
│  정답: "これをください"          │
│                                 │
│  [다음 대사]                    │
└─────────────────────────────────┘
```

**Case B: 부분 일치**
```
┌─────────────────────────────────┐
│  🔶 거의 맞았어요!               │
│                                 │
│  당신: "これください"            │
│  정답: "これ**を**ください"      │
│                                 │
│  💡 "を"는 목적어를 나타내요     │
│                                 │
│  [다시 말하기] [넘어가기]        │
└─────────────────────────────────┘
```

**Case C: 오답**
```
┌─────────────────────────────────┐
│  ❌ 다시 들어볼까요?             │
│                                 │
│  당신: "고레오 쿠다사이"         │  ← STT가 일본어 인식 실패
│  정답: "これをください"          │
│                                 │
│  🔊 [정답 듣기]                 │
│  [다시 말하기]                  │
└─────────────────────────────────┘
```

### 3.5 상황 완료

```
[상황 완료 화면]
    ┌─────────────────────────────┐
    │ 🎉 "편의점에서 계산" 완료!   │
    │                             │
    │ 배운 표현:                  │
    │ • これをください            │
    │ • ありがとうございます      │
    │                             │
    │ 정확도: 85%                 │
    │                             │
    │ [다음 상황] [홈으로]         │
    └─────────────────────────────┘
```

---

## 4. 세션 종료

```
[세션 완료 화면]
    ┌─────────────────────────────┐
    │ 오늘의 학습 완료! 🎊         │
    │                             │
    │ 복습: 3개 ✅                │
    │ 신규: 1개 ✅                │
    │                             │
    │ 총 학습 시간: 8분           │
    │ 연속 학습: 4일째 🔥         │
    │                             │
    │ 🎁 Daily 리워드 획득!       │
    │                             │
    │ 내일 복습 예정: 2개          │
    │                             │
    │ [홈으로]                    │
    └─────────────────────────────┘
```

### Daily 리워드 시스템

| 연속 학습 | 리워드 |
|----------|--------|
| 3일 | 배지 획득 |
| 7일 | 새 상황 조기 해금 |
| 30일 | ??? (TBD) |

※ 리워드는 동기부여용, P2W 요소 없음

---

## 4.1 Backend 처리 흐름 (참고)

```
[매일 자동 실행]
    ↓
FSRS 알고리즘으로 복습 대상 선정
    ↓
Organize: 오늘의 세션 구성
  - 복습 우선 (FSRS due)
  - 신규 1~2개 추가
    ↓
Execute: 사용자가 학습 시작하면 제공
```

---

## 5. 기타 화면

### 5.1 전체 상황 보기

```
[상황 목록]
    🗼 관광
    ├─ ✅ 편의점에서 물 사기
    ├─ ✅ 카페 주문
    ├─ 🔒 식당 예약 (Lv.3 필요)
    └─ ...

    💼 비즈니스
    ├─ 🔒 (관광 기초 완료 후 해금)
    └─ ...
```

### 5.2 학습 기록 (History)

```
[학습 기록]
    ├─ 오늘: 4개 상황 완료
    ├─ 이번 주: 15개 상황
    ├─ 총 학습 시간: 2시간 30분
    │
    ├─ [달력 보기] ← 날짜별 학습 현황
    └─ [통계 보기] ← 정확도 추이 등
```

### 5.3 단어장

```
[단어장]
    ├─ 배운 표현: 45개
    │   ├─ ください (15회 연습)
    │   ├─ ありがとうございます (12회)
    │   └─ ...
    │
    ├─ [약한 표현] ← 정확도 낮은 것
    └─ [즐겨찾기]
```

### 5.4 설정

```
[설정]
    ├─ 페르소나 변경
    ├─ 하루 학습량 (1개/3개/5개)
    ├─ 음성 속도 (느리게/보통/빠르게)
    ├─ 힌트 기본값 (항상 보기/숨기기)
    ├─ 시간 제한 기본값 (ON/OFF)
    └─ 알림 설정
```

---

## 열린 질문

1. ~~**예시 보기 기본값**~~ → ✅ 해결: 레벨별 scaffolding 적용 + 설정에서 오버라이드 가능
2. ~~**정답 비교 엄격도**~~ → ✅ 해결: 레벨별 채점 기준 (Lv.1 단어만 → Lv.2 조사 포함 → Lv.3 정확한 문장)
3. ~~**레벨/해금 시스템**~~ → ✅ 해결: 복습은 FSRS 고정, 신규는 초반 가이드 → 중반 이후 자유 선택
4. ~~**복습 실패 시**~~ → ✅ 해결: 틀린 대사만 반복 연습 (상황 전체 X)
